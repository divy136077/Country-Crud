{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport * as Excel from 'exceljs/dist/exceljs.min.js';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"ngx-toastr\";\nimport * as i2 from \"src/app/_metronic/core/services/common.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/form-field\";\nimport * as i7 from \"@ngx-translate/core\";\n\nfunction MultiImportComponent_mat_error_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 1, \"AUTH.VALIDATION.REQUIRED_FIELD\"), \" \");\n  }\n}\n\nfunction MultiImportComponent_mat_error_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.errorMessage, \" \");\n  }\n}\n\nfunction MultiImportComponent_div_27_div_3_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r5.successData, \" job added sucessfully\");\n  }\n}\n\nfunction MultiImportComponent_div_27_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"p\", 22);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, MultiImportComponent_div_27_div_3_p_3_Template, 2, 1, \"p\", 23);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Failed to import! Error in rows(\", ctx_r3.faildData.toString(), \") - either records already exist in database or job id entered is not 6 digit value\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.successData);\n  }\n}\n\nfunction MultiImportComponent_div_27_div_4_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r6.successData, \" hours entry added sucessfully\");\n  }\n}\n\nfunction MultiImportComponent_div_27_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"p\", 22);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, MultiImportComponent_div_27_div_4_p_3_Template, 2, 1, \"p\", 23);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" Failed to import! Error in rows(\", ctx_r4.faildData.toString(), \") - either employee id, phase id or job id are not found in database or employee or phase is not assigned in job \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r4.successData);\n  }\n}\n\nfunction MultiImportComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵelementStart(1, \"div\");\n    i0.ɵɵelementStart(2, \"i\", 21);\n    i0.ɵɵlistener(\"click\", function MultiImportComponent_div_27_Template_i_click_2_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.closeResponse();\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, MultiImportComponent_div_27_div_3_Template, 4, 2, \"div\", 12);\n    i0.ɵɵtemplate(4, MultiImportComponent_div_27_div_4_Template, 4, 2, \"div\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.moduleNameServiceRoute === \"job\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.moduleNameServiceRoute !== \"job\");\n  }\n}\n\nexport let MultiImportComponent = /*#__PURE__*/(() => {\n  class MultiImportComponent {\n    constructor(cdr, toastr, commonService, router) {\n      this.cdr = cdr;\n      this.toastr = toastr;\n      this.commonService = commonService;\n      this.router = router;\n      this.moduleNameServiceRoute = 'user';\n      this.isShowMessage = false;\n      this.title = '';\n    }\n\n    ngOnInit() {}\n\n    onFilesAdded(event) {\n      if (event.target.files && event.target.files[0]) {\n        if (event.target.files[0].size < 5242880 && (event.target.files[0].type === 'application/vnd.ms-excel' || event.target.files[0].type === 'text/csv' || event.target.files[0].type === 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')) {\n          this.isShowMessage = false;\n          this.files = event.target.files[0];\n          let reader = new FileReader();\n\n          reader.onload = e => __awaiter(this, void 0, void 0, function* () {\n            if (this.files.name.split('.')[1] === 'csv') {\n              const csvData = reader.result;\n              const csvRecordsArray = csvData.trim().split(/\\r\\n|\\n/);\n              this.dataLength = csvRecordsArray.length - 1;\n            } else {\n              this.workbook = new Excel.Workbook();\n              const arryBuffer = yield this.files.arrayBuffer();\n              yield this.workbook.xlsx.load(arryBuffer);\n              const worksheet = this.workbook.getWorksheet(1);\n              this.dataLength = worksheet.rowCount - 1;\n            }\n\n            if (this.dataLength > 100) {\n              this.errorMessage = `You can't add more than 100 record`;\n            } else {\n              this.errorMessage = '';\n            }\n\n            this.cdr.detectChanges();\n          });\n\n          reader.readAsText(this.files);\n        } else {\n          this.isShowMessage = true;\n          this.toastr.error('You have uploaded an invalid file type or Maximum upload file size: 5 MB!', 'Error!');\n        }\n      }\n    }\n    /**\r\n     * Form Submit\r\n     */\n\n\n    addHoursEntry() {\n      if (!this.files) {\n        this.isShowMessage = true;\n        return;\n      }\n\n      if (this.errorMessage) {\n        return;\n      }\n\n      let formData = new FormData();\n\n      if (this.files) {\n        this.isShowMessage = false;\n        formData.append('file', this.files);\n      }\n\n      this.commonService.bulkimport(formData, this.moduleNameServiceRoute).subscribe(res => {\n        if (res.status) {\n          this.router.navigate(['user']).then(() => {\n            this.toastr.success(res.message, 'Success!');\n          });\n        } else {\n          if (res.message) {\n            this.toastr.error(res.message, 'Error!');\n          }\n        }\n      });\n    }\n\n    closeResponse() {\n      this.faildData = null;\n    }\n\n  }\n\n  MultiImportComponent.ɵfac = function MultiImportComponent_Factory(t) {\n    return new (t || MultiImportComponent)(i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i1.ToastrService), i0.ɵɵdirectiveInject(i2.CommonService), i0.ɵɵdirectiveInject(i3.Router));\n  };\n\n  MultiImportComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MultiImportComponent,\n    selectors: [[\"app-multi-import\"]],\n    decls: 63,\n    vars: 13,\n    consts: [[1, \"card\", \"card-custom\", \"gutter-b\"], [1, \"card-header\"], [1, \"card-title\"], [1, \"card-label\"], [1, \"card-toolbar\"], [\"ktPortletTools\", \"\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 1, \"mr-2\", 3, \"href\", \"download\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"href\", \"download\"], [1, \"card-body\"], [1, \"row\", \"m-0\"], [1, \"col-6\"], [\"type\", \"file\", \"name\", \"File Upload\", \"id\", \"txtFileUpload\", \"accept\", \".csv,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", 1, \"mb-2\", 3, \"change\"], [4, \"ngIf\"], [1, \"row\", \"mt-3\"], [1, \"col-10\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", 3, \"click\"], [\"mat-raised-button\", \"\", \"color\", \"warn\", \"routerLink\", \"/job\"], [\"class\", \"col-6 card  p-3 response-section\", 4, \"ngIf\"], [1, \"row\", \"mt-5\", \"mx-0\"], [1, \"col-12\"], [1, \"col-6\", \"card\", \"p-3\", \"response-section\"], [\"aria-hidden\", \"true\", 1, \"fa\", \"fa-times-circle\", \"close-icon\", 3, \"click\"], [1, \"text-danger\"], [\"class\", \"text-success\", 4, \"ngIf\"], [1, \"text-success\"]],\n    template: function MultiImportComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"h3\", 3);\n        i0.ɵɵtext(4, \"Import User Data\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 4);\n        i0.ɵɵelementContainerStart(6, 5);\n        i0.ɵɵelementStart(7, \"a\", 6);\n        i0.ɵɵtext(8, \"Sample xlsx\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"a\", 7);\n        i0.ɵɵtext(10, \"Sample csv\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 8);\n        i0.ɵɵelementStart(12, \"div\", 9);\n        i0.ɵɵelementStart(13, \"div\", 10);\n        i0.ɵɵelementStart(14, \"input\", 11);\n        i0.ɵɵlistener(\"change\", function MultiImportComponent_Template_input_change_14_listener($event) {\n          return ctx.onFilesAdded($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\");\n        i0.ɵɵtemplate(16, MultiImportComponent_mat_error_16_Template, 3, 3, \"mat-error\", 12);\n        i0.ɵɵtemplate(17, MultiImportComponent_mat_error_17_Template, 2, 1, \"mat-error\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"div\", 13);\n        i0.ɵɵelementStart(19, \"div\", 14);\n        i0.ɵɵelementStart(20, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function MultiImportComponent_Template_button_click_20_listener() {\n          return ctx.addHoursEntry();\n        });\n        i0.ɵɵtext(21);\n        i0.ɵɵpipe(22, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(23, \"\\u00A0\\u00A0 \");\n        i0.ɵɵelementStart(24, \"a\", 16);\n        i0.ɵɵtext(25);\n        i0.ɵɵpipe(26, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(27, MultiImportComponent_div_27_Template, 5, 2, \"div\", 17);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"div\", 18);\n        i0.ɵɵelementStart(29, \"div\", 19);\n        i0.ɵɵelementStart(30, \"h4\");\n        i0.ɵɵtext(31, \"Instructions:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(32, \"ul\");\n        i0.ɵɵelementStart(33, \"li\");\n        i0.ɵɵtext(34, \"first_name contains First name which is entered while adding user \");\n        i0.ɵɵelementStart(35, \"strong\");\n        i0.ɵɵtext(36, \"e.g.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(37, \" John\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(38, \"li\");\n        i0.ɵɵtext(39, \"last_name contains Last name which is entered while adding user \");\n        i0.ɵɵelementStart(40, \"strong\");\n        i0.ɵɵtext(41, \"e.g.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(42, \" Doe\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(43, \"li\");\n        i0.ɵɵtext(44, \"email contains Email which is entered while addling user \");\n        i0.ɵɵelementStart(45, \"strong\");\n        i0.ɵɵtext(46, \"e.g.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(47, \" abc@gmail.com\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(48, \"li\");\n        i0.ɵɵtext(49, \"password contains Password \");\n        i0.ɵɵelementStart(50, \"strong\");\n        i0.ɵɵtext(51, \"e.g.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(52, \" Abc@12345\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(53, \"li\");\n        i0.ɵɵtext(54, \"phone contains Phone \");\n        i0.ɵɵelementStart(55, \"strong\");\n        i0.ɵɵtext(56, \"e.g.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(57, \" 7875454521 \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(58, \"li\");\n        i0.ɵɵtext(59, \"role_id contains Role name \");\n        i0.ɵɵelementStart(60, \"strong\");\n        i0.ɵɵtext(61, \"e.g.\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(62, \" admin \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"href\", ctx.excelPath, i0.ɵɵsanitizeUrl)(\"download\", ctx.excelName);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"href\", ctx.csvPath, i0.ɵɵsanitizeUrl)(\"download\", ctx.csvName);\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngIf\", ctx.isShowMessage);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(22, 9, \"BUTTONS.SUBMIT\"));\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(26, 11, \"BUTTONS.CANCEL\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.faildData);\n      }\n    },\n    directives: [i4.MatAnchor, i5.NgIf, i4.MatButton, i3.RouterLinkWithHref, i6.MatError],\n    pipes: [i7.TranslatePipe],\n    styles: [\"\"]\n  });\n  return MultiImportComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}